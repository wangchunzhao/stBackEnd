<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.qhc.order.mapper.ReportMapper" >
	
	<!-- 购销明细报表 -->
	<select id="findPurchaseAndSalesReport" resultType="Map" parameterType="Map" >
		select 
			oi.id,
			o.sequence_number as sequenceNumber, <!-- 需求流水号 -->
			oi.contract_number as contractNumber, <!-- 合同号 -->
			sc.name as customerName, <!-- 签约单位 -->
			oi.shop_name as shopName, <!-- 店名 -->
			u.name as salesName, <!-- 客户经理名称 -->
			oi.is_reformed as isReformed, <!-- 是否改造店 -->
			oi.is_new as isNew, <!-- 是否新客户 -->
			oi.is_convenient_store as isConvenientStore, <!-- 是否便利店 -->
			si.name as industryName, <!-- 隶属关系 -->
			sit.name as customerIndustryCodeName, <!-- 客户分类 -->
			oi.sale_type as saleType, <!-- 销售类型 -->
			oi.contract_Value as contractValue, <!-- 合同金额（凭证货币） -->
			oi.contract_Rmb_Value as contractRmbValue, <!-- 原币合同金额 -->
			oi.create_time as createTime, <!-- 订单创建日期 -->
			so.name as officeName, <!-- 大区 -->
			sg.name as groupName, <!-- 中心 -->
			oi.status, <!-- 订单状态 -->
			sc.sap_industry_code_code as industryCodeName, <!-- 性质分类/客户分类 -->
			cmu.name as contractManager, <!-- 合同管理员 -->
			o.st_order_type as stOrderType, <!-- 订单类型 -->
			0 as isYearpurchase, <!-- 是否年采客户 -->
			oi.record_code as recordCode, <!-- 项目报备编号 -->
			oi.tax_rate as taxRate, <!-- 税率 -->
			oi.currency, <!-- 币种 -->
			oi.currency_exchange as exchange, <!-- 汇率 -->
			oi.incoterm, <!-- 国际贸易条件1 -->
			oi.incoterm_contect as incotermContect, <!-- 国际贸易条件2 -->
			oi.warranty, <!-- 保修年限 -->
			oi.install_type as installType, <!-- 安装方式 -->
			'' as city, <!-- 省市区 -->
			'' as address, <!-- 到货地址 -->
			oi.transfer_type as transferType, <!-- 运输方式 -->
			oi.additional_freight as additionalFreight, <!-- 追加运费 -->
			oi.freight, <!-- 外销运费 -->
			oi.contactor1_id as contactor1Id, <!-- 授权人1及身份证号 -->
			oi.contactor1_tel as contactor1Tel, <!-- 授权人1电话 -->
			oi.contactor2_id as contactor2Id, <!-- 授权人2及身份证号 -->
			oi.contactor2_tel as contactor2Tel, <!-- 授权人2电话 -->
			oi.contactor3_id as contactor3Id, <!-- 授权人3及身份证号 -->
			oi.contactor3_tel as contactor3Tel, <!-- 授权人3电话 -->
			oi.payment_type as paymentType, <!-- 结算方式 -->
			oi.earliest_delivery_date as earliestDeliveryDate, <!-- 要求发货时间 -->
			oi.is_term1 as isTerm1, <!-- 柜体控制阀件是否甲供 -->
			oi.is_term2 as isTerm2, <!-- 分体归是否远程监控 -->
			oi.is_term3 as isTerm3, <!-- 立柜柜体是否在地下室 -->
			oi.is_urgent_delivery as isUrgentDelivery, <!-- 是否特批发货 -->
			oi.is_special_order as isSpecialOrder, <!-- 是否特批下单 -->
			oi.gross_profit_margin, <!-- 销售毛利率 -->
			
			item.row_num as rowNum, <!-- 行号 -->
			m.description as materialName, <!-- 规格型号 -->
			item.material_code as materialCode, <!-- 专用号 -->
			item.item_status as itemStatus, <!-- 状态 -->
			item.item_requirement_plan as itemRequirementPlan, <!-- 需求计划 -->
			m.sap_material_groups_code as materialGroupCode, <!-- 类型 -->
			item.quantity, <!-- 数量 -->
			m.sap_unit_of_measurement_code as unitCode, <!-- 计量单位 -->
			item.actual_price / oi.currency_exchange as actualPrice, <!-- 产品实卖单价（凭证货币） -->
			0 as actualAmount, <!-- 产品实卖金额（凭证货币） -->
			item.transaction_price as transactionPrice, <!-- 产品转移单价（凭证货币） -->
			0 as transactionPriceAmount, <!-- 产品转移金额（凭证货币） -->
			item.optional_actual_price as optionalActualPrice, <!-- 可选项实卖单价（凭证货币） -->
			0 as originalOptionalActualPrice, <!-- 可选项实卖金额（凭证货币） -->
			item.optional_transaction_price as optionalTransactionPrice, <!-- 可选项转移单价（凭证货币） -->
			0 as optionalTransationPriceAmount, <!-- 可选项转移金额（凭证货币） -->
			item.b2c_estimated_price as b2cEstimatedPrice, <!-- B2C预估单价（CNY） -->
			0 as b2cEstimatedAmount, <!-- B2C预估金额（CNY） -->
			item.b2c_estimated_cost as b2cEstimatedCost, <!-- B2C预估成本单价 -->
			0 as b2cEstimatedCostAmount, <!-- B2C预估成本金额 -->
			0 as actualPriceSum, <!-- 实卖单价小计（凭证货币） -->
			0 as actualAmountSum, <!-- 实卖金额合计（凭证货币） -->
			0 as transactionPriceSum, <!-- 转移单价小计 -->
			0 as transactionAmountSum, <!-- 转移金额合计 -->
			item.retail_price as retailPrice, <!-- 市场零售价（CNY） -->
			0 as retailAmount, <!-- 市场零售金额（CNY） -->
			item.discount, <!-- 折扣率 -->
			item.item_category as itemCategory,  <!-- 行项目类别 -->
			m.is_purchased as isPurchased, <!-- 物料属性 -->
			item.period, <!-- 生产周期 -->
			item.delivery_date as deliveryDate, <!-- 工厂最早交货时间 -->
			item.produce_date as produceDate, <!-- 生产开始时间 -->
			item.shipp_date as shippDate, <!-- 要求发货时间 -->
			item.on_store_date as onStoreDate, <!-- 入库时间 -->
			item.b2c_comments as b2cComments, <!-- B2C备注 -->
			item.special_comments as specialComments, <!-- 特殊备注 -->
			item.color_comments as colorComments <!-- 颜色备注 -->
		from k_order_info oi
		inner join k_order o on o.id = oi.order_id
		left join sap_customer sc on sc.code = o.customer_code
		left join sap_industry_code sit on sit.code = sc.sap_industry_code_code
		left join sap_industry_and_customer sic on sic.sap_customer_code = o.customer_code
		left join sap_industry si on si.code = si.code = sic.sap_industry_code
		left join k_contract c on c.order_info_id = oi.id
		left join sap_sales_office so on so.code = oi.office_code
		left join sap_sales_group sg on sg.code = oi.group_code
        LEFT JOIN b_user u on u.user_identity=oi.creater
        LEFT JOIN b_user cmu on cmu.user_identity=oi.contract_manager
        LEFT JOIN k_item item on item.order_info_id=oi.id
        LEFT JOIN sap_materials m on m.code = item.material_code
		<trim prefix="WHERE" prefixOverrides="AND|OR" >
			oi.is_active = 1 and oi.status != '00'
			<!-- 权限范围 -->
			<if test="scope == 0" >
				AND u.user_identity = #{userid, jdbcType=VARCHAR} 
			</if>
			<if test="scope == 1" >
				AND u.office_code = #{region, jdbcType=VARCHAR} 
			</if>
			<!-- 需求流水号 -->
			<if test="sequenceNumber != null and sequenceNumber != ''" >
				AND UPPER(o.sequence_number) like '%${sequenceNumber.toUpperCase()}%' 
			</if>
			<!-- 合同号 -->
			<if test="contractNumber != null and contractNumber != ''" >
				AND UPPER(oi.contract_number) like '%${contractNumber.toUpperCase()}%' 
			</if>
			<!-- 签约单位 -->
			<if test="customerName != null and customerName != ''" >
				AND (UPPER(sc.code) like '%${customerName.toUpperCase()}%' or UPPER(sc.name) like '%${customerName.toUpperCase()}%') 
			</if>
			<!-- 客户经理名称 -->
			<if test="salesName != null and salesName != ''" >
				AND UPPER(u.name) like '%${salesName.toUpperCase()}%' 
			</if>
			<!-- 隶属关系 -->
			<if test="industry != null and industry != ''" >
				AND sic.sap_industry_code = #{industry, jdbcType=VARCHAR} 
			</if>
			<!-- 客户分类 -->
			<if test="industryCode != null and industryCode != ''" >
				AND sc.sap_industry_code_code = #{industryCode, jdbcType=VARCHAR} 
			</if>
			<!-- 销售类型 -->
			<if test="saleType != null and saleType != ''" >
				AND oi.sale_type = #{saleType, jdbcType=VARCHAR} 
			</if>
			<!-- 原币合同金额 -->
			<if test="contractAmount1 != null and contractAmount1 != ''" >
				AND oi.contract_rmb_value >= ${contractAmount1} 
			</if>
			<if test="contractAmount2 != null and contractAmount2 != ''" >
				<![CDATA[
				AND oi.contract_rmb_value <= ${contractAmount2} 
				]]>
			</if>
			<!-- 订单创建日期 -->
			<!-- 2019-04-07 - 2019-11-07 -->
			<if test="createTime != null and createTime != ''" >
			<![CDATA[
				AND DATE_FORMAT(oi.create_time, '%Y-%m-%d') >= '${createTime.substring(0, createTime.indexOf(" - "))}' and DATE_FORMAT(oi.create_time, '%Y-%m-%d') <= '${createTime.substring(createTime.indexOf(" - ") + 3)}'
			]]>
			</if>
			<!-- 大区 -->
			<if test="officeCode != null and officeCode != ''" >
				AND oi.office_code = #{officeCode, jdbcType=VARCHAR} 
			</if>
			<!-- 订单状态 -->
			<if test="status != null and status != ''" >
				AND oi.status = #{status, jdbcType=CHAR}
			</if>
			<!-- 性质分类 -->
			<!-- <if test="industryCode != null and industryCode != ''" >
				AND sc.sap_industry_code_code = #{industryCode, jdbcType=CHAR}
			</if> -->
			<!-- 合同管理员 -->
			<if test="contractManager != null and contractManager != ''" >
				AND UPPER(cmu.name) like '%${contractManager.toUpperCase()}%' 
			</if>
			<!-- 订单类型 -->
			<if test="stOrderType != null and stOrderType != ''" >
				AND o.st_order_type = #{stOrderType, jdbcType=CHAR}
			</if>
			<!-- 专用号 -->
			<if test="materialName != null and materialName != ''" >
				AND UPPER(m.code) like '%${stOrderType.toUpperCase()}%' 
			</if>
			<!-- 需求计划 -->
			<if test="requirementPlan != null and requirementPlan != ''" >
				AND item.item_requirement_plan = #{requirementPlan, jdbcType=CHAR}
			</if>
			<!-- 行项目类别 -->
			<if test="itemCategory != null and itemCategory != ''" >
				AND item.item_category = #{itemCategory, jdbcType=CHAR}
			</if>
			<!-- 入库时间 -->
			<if test="onStoreDate != null and onStoreDate != ''" >
			<![CDATA[
				AND DATE_FORMAT(item.on_store_date, '%Y-%m-%d') >= '${onStoreDate.substring(0, onStoreDate.indexOf(" - "))}' and DATE_FORMAT(item.on_store_date, '%Y-%m-%d') <= '${onStoreDate.substring(onStoreDate.indexOf(" - ") + 3)}'
			]]>
			</if>
			<!-- 要求发货时间 -->
			<if test="shippDate != null and shippDate != ''" >
			<![CDATA[
				AND DATE_FORMAT(item.shipp_date, '%Y-%m-%d') >= '${shippDate.substring(0, shippDate.indexOf(" - "))}' and DATE_FORMAT(item.shipp_date, '%Y-%m-%d') <= '${shippDate.substring(shippDate.indexOf(" - ") + 3)}'
			]]>
			</if>
		</trim>
		order by o.id,oi.id,item.id
	</select>
	
	<!-- 投标跟踪报表 -->
	<select id="findBiddingReport" resultType="Map" parameterType="Map" >
		select 
			oi.id,
			o.sequence_number as sequenceNumber, <!-- 需求流水号 -->
			oi.contract_number as contractNumber, <!-- 合同号 -->
			sc.name as customerName, <!-- 签约单位 -->
			oi.shop_name as shopName, <!-- 店名 -->
			u.name as salesName, <!-- 客户经理名称 -->
			oi.is_reformed as isReformed, <!-- 是否改造店 -->
			oi.is_new as isNew, <!-- 是否新客户 -->
			oi.is_convenient_store as isConvenientStore, <!-- 是否便利店 -->
			si.name as industryName, <!-- 隶属关系 -->
			sit.name as customerIndustryCodeName, <!-- 客户分类 -->
			oi.sale_type as saleType, <!-- 销售类型 -->
			oi.contract_Rmb_Value as contractRmbValue, <!-- 原币合同金额 -->
			oi.create_time as createTime, <!-- 订单创建日期 -->
			so.name as officeName, <!-- 大区 -->
			sg.name as groupName, <!-- 中心 -->
			oi.gross_profit_margin, <!-- 销售毛利率 -->
			o.quote_status as quoteStatus, <!-- 是否中标 -->
			oi.status <!-- 订单状态 -->
		from k_order_info oi
		inner join k_order o on o.id = oi.order_id
		left join sap_customer sc on sc.code = o.customer_code
		left join sap_industry_code sit on sit.code = sc.sap_industry_code_code
		left join sap_industry_and_customer sic on sic.sap_customer_code = o.customer_code
		left join sap_industry si on si.code = si.code = sic.sap_industry_code
		left join k_contract c on c.order_info_id = oi.id
		left join sap_sales_office so on so.code = oi.office_code
		left join sap_sales_group sg on sg.code = oi.group_code
        LEFT JOIN b_user u on u.user_identity=oi.creater
		<trim prefix="WHERE" prefixOverrides="AND|OR" >
			oi.is_active = 1 and o.st_order_type = 3 and oi.status = '05'
			<!-- 权限范围 -->
			<if test="scope == 0" >
				AND u.user_identity = #{userid, jdbcType=VARCHAR} 
			</if>
			<if test="scope == 1" >
				AND u.office_code = #{region, jdbcType=VARCHAR} 
			</if>
			<!-- 需求流水号 -->
			<if test="sequenceNumber != null and sequenceNumber != ''" >
				AND UPPER(o.sequence_number) like '%${sequenceNumber.toUpperCase()}%' 
			</if>
			<!-- 合同号 -->
			<if test="contractNumber != null and contractNumber != ''" >
				AND UPPER(oi.contract_number) like '%${contractNumber.toUpperCase()}%' 
			</if>
			<!-- 签约单位 -->
			<if test="customerName != null and customerName != ''" >
				AND (UPPER(sc.code) like '%${customerName.toUpperCase()}%' or UPPER(sc.name) like '%${customerName.toUpperCase()}%') 
			</if>
			<!-- 客户经理名称 -->
			<if test="salesName != null and salesName != ''" >
				AND UPPER(u.name) like '%${salesName.toUpperCase()}%' 
			</if>
			<!-- 隶属关系 -->
			<if test="industry != null and industry != ''" >
				AND sic.sap_industry_code = #{industry, jdbcType=VARCHAR} 
			</if>
			<!-- 客户分类 -->
			<if test="industryCode != null and industryCode != ''" >
				AND sc.sap_industry_code_code = #{industryCode, jdbcType=VARCHAR} 
			</if>
			<!-- 销售类型 -->
			<if test="saleType != null and saleType != ''" >
				AND oi.sale_type = #{saleType, jdbcType=VARCHAR} 
			</if>
			<!-- 原币合同金额 -->
			<if test="contractAmount1 != null and contractAmount1 != ''" >
				AND oi.contract_rmb_value >= ${contractAmount1} 
			</if>
			<if test="contractAmount2 != null and contractAmount2 != ''" >
				<![CDATA[
				AND oi.contract_rmb_value <= ${contractAmount2} 
				]]>
			</if>
			<!-- 订单创建日期 -->
			<!-- 2019-04-07 - 2019-11-07 -->
			<if test="createTime != null and createTime != ''" >
			<![CDATA[
				AND DATE_FORMAT(oi.create_time, '%Y-%m-%d') >= '${createTime.substring(0, createTime.indexOf(" - "))}' and DATE_FORMAT(oi.create_time, '%Y-%m-%d') <= '${createTime.substring(createTime.indexOf(" - ") + 3)}'
			]]>
			</if>
			<!-- 大区 -->
			<if test="officeCode != null and officeCode != ''" >
				AND oi.office_code = #{officeCode, jdbcType=VARCHAR} 
			</if>
			<!-- 是否中标 -->
			<if test=' winning != null and winning == "Y" ' >
				AND (o.quote_status = '01' or o.quote_status = '02')
			</if>
			<if test=' winning != null and winning == "N" ' >
				AND o.quote_status = '05'
			</if>
			<!-- 是否下单 -->
			<if test=' makingorder != null and makingorder == "Y" ' >
				AND o.quote_status = '02'
			</if>
			<if test=' makingorder != null and makingorder == "N" ' >
				AND o.quote_status != '02'
			</if>
			<!-- 订单状态 -->
			<if test="status != null and status != ''" >
				AND oi.status = #{status, jdbcType=CHAR}
			</if>
		</trim>
	</select>
	
	<!-- 销售订单汇总报表 -->
	<select id="findOrderSummaryReport" resultType="Map" parameterType="Map" >
		select 
			oi.id,
			o.sequence_number as sequenceNumber, <!-- 需求流水号 -->
			oi.contract_number as contractNumber, <!-- 合同号 -->
			sc.name as customerName, <!-- 签约单位 -->
			oi.shop_name as shopName, <!-- 店名 -->
			u.name as salesName, <!-- 客户经理名称 -->
			oi.is_reformed as isReformed, <!-- 是否改造店 -->
			oi.is_new as isNew, <!-- 是否新客户 -->
			oi.is_convenient_store as isConvenientStore, <!-- 是否便利店 -->
			si.name as industryName, <!-- 隶属关系 -->
			sit.name as customerIndustryCodeName, <!-- 客户分类 -->
			oi.sale_type as saleType, <!-- 销售类型 -->
			oi.contract_Value as contractValue, <!-- 合同金额（凭证货币） -->
			oi.contract_Rmb_Value as contractRmbValue, <!-- 原币合同金额 -->
			oi.create_time as createTime, <!-- 订单创建日期 -->
			so.name as officeName, <!-- 大区 -->
			sg.name as groupName, <!-- 中心 -->
			oi.status, <!-- 订单状态 -->
			sc.sap_industry_code_code as industryCodeName, <!-- 性质分类/客户分类 -->
			cmu.name as contractManager, <!-- 合同管理员 -->
			o.st_order_type as stOrderType, <!-- 订单类型 -->
			0 as isYearpurchase, <!-- 是否年采客户 -->
			oi.record_code as recordCode, <!-- 项目报备编号 -->
			oi.tax_rate as taxRate, <!-- 税率 -->
			oi.currency, <!-- 币种 -->
			oi.currency_exchange as exchange, <!-- 汇率 -->
			oi.incoterm, <!-- 国际贸易条件1 -->
			oi.incoterm_contect as incotermContect, <!-- 国际贸易条件2 -->
			oi.warranty, <!-- 保修年限 -->
			oi.install_type as installType, <!-- 安装方式 -->
			'' as city, <!-- 省市区 -->
			'' as address, <!-- 到货地址 -->
			oi.transfer_type as transferType, <!-- 运输方式 -->
			oi.additional_freight as additionalFreight, <!-- 追加运费 -->
			oi.freight, <!-- 外销运费 -->
			oi.contactor1_id as contactor1Id, <!-- 授权人1及身份证号 -->
			oi.contactor1_tel as contactor1Tel, <!-- 授权人1电话 -->
			oi.contactor2_id as contactor2Id, <!-- 授权人2及身份证号 -->
			oi.contactor2_tel as contactor2Tel, <!-- 授权人2电话 -->
			oi.contactor3_id as contactor3Id, <!-- 授权人3及身份证号 -->
			oi.contactor3_tel as contactor3Tel, <!-- 授权人3电话 -->
			oi.payment_type as paymentType, <!-- 结算方式 -->
			oi.earliest_delivery_date as earliestDeliveryDate, <!-- 要求发货时间 -->
			oi.is_term1 as isTerm1, <!-- 柜体控制阀件是否甲供 -->
			oi.is_term2 as isTerm2, <!-- 分体归是否远程监控 -->
			oi.is_term3 as isTerm3, <!-- 立柜柜体是否在地下室 -->
			oi.is_urgent_delivery as isUrgentDelivery, <!-- 是否特批发货 -->
			oi.is_special_order as isSpecialOrder, <!-- 是否特批下单 -->
			oi.gross_profit_margin <!-- 销售毛利率 -->
		from k_order_info oi
		inner join k_order o on o.id = oi.order_id
		left join sap_customer sc on sc.code = o.customer_code
		left join sap_industry_code sit on sit.code = sc.sap_industry_code_code
		left join sap_industry_and_customer sic on sic.sap_customer_code = o.customer_code
		left join sap_industry si on si.code = si.code = sic.sap_industry_code
		left join k_contract c on c.order_info_id = oi.id
		left join sap_sales_office so on so.code = oi.office_code
		left join sap_sales_group sg on sg.code = oi.group_code
        LEFT JOIN b_user u on u.user_identity=oi.creater
        LEFT JOIN b_user cmu on cmu.user_identity=oi.contract_manager
		<trim prefix="WHERE" prefixOverrides="AND|OR" >
			oi.is_active = 1 and oi.status != '00'
			<!-- 权限范围 -->
			<if test="scope == 0" >
				AND u.user_identity = #{userid, jdbcType=VARCHAR} 
			</if>
			<if test="scope == 1" >
				AND u.office_code = #{region, jdbcType=VARCHAR} 
			</if>
			<!-- 需求流水号 -->
			<if test="sequenceNumber != null and sequenceNumber != ''" >
				AND UPPER(o.sequence_number) like '%${sequenceNumber.toUpperCase()}%' 
			</if>
			<!-- 合同号 -->
			<if test="contractNumber != null and contractNumber != ''" >
				AND UPPER(oi.contract_number) like '%${contractNumber.toUpperCase()}%' 
			</if>
			<!-- 签约单位 -->
			<if test="customerName != null and customerName != ''" >
				AND (UPPER(sc.code) like '%${customerName.toUpperCase()}%' or UPPER(sc.name) like '%${customerName.toUpperCase()}%') 
			</if>
			<!-- 客户经理名称 -->
			<if test="salesName != null and salesName != ''" >
				AND UPPER(u.name) like '%${salesName.toUpperCase()}%' 
			</if>
			<!-- 隶属关系 -->
			<if test="industry != null and industry != ''" >
				AND sic.sap_industry_code = #{industry, jdbcType=VARCHAR} 
			</if>
			<!-- 客户分类 -->
			<if test="industryCode != null and industryCode != ''" >
				AND sc.sap_industry_code_code = #{industryCode, jdbcType=VARCHAR} 
			</if>
			<!-- 销售类型 -->
			<if test="saleType != null and saleType != ''" >
				AND oi.sale_type = #{saleType, jdbcType=VARCHAR} 
			</if>
			<!-- 原币合同金额 -->
			<if test="contractAmount1 != null and contractAmount1 != ''" >
				AND oi.contract_rmb_value >= ${contractAmount1} 
			</if>
			<if test="contractAmount2 != null and contractAmount2 != ''" >
				<![CDATA[
				AND oi.contract_rmb_value <= ${contractAmount2} 
				]]>
			</if>
			<!-- 订单创建日期 -->
			<!-- 2019-04-07 - 2019-11-07 -->
			<if test="createTime != null and createTime != ''" >
			<![CDATA[
				AND DATE_FORMAT(oi.create_time, '%Y-%m-%d') >= '${createTime.substring(0, createTime.indexOf(" - "))}' and DATE_FORMAT(oi.create_time, '%Y-%m-%d') <= '${createTime.substring(createTime.indexOf(" - ") + 3)}'
			]]>
			</if>
			<!-- 大区 -->
			<if test="officeCode != null and officeCode != ''" >
				AND oi.office_code = #{officeCode, jdbcType=VARCHAR} 
			</if>
			<!-- 订单状态 -->
			<if test="status != null and status != ''" >
				AND oi.status = #{status, jdbcType=CHAR}
			</if>
			<!-- 性质分类 -->
			<!-- <if test="industryCode != null and industryCode != ''" >
				AND sc.sap_industry_code_code = #{industryCode, jdbcType=CHAR}
			</if> -->
			<!-- 合同管理员 -->
			<if test="contractManager != null and contractManager != ''" >
				AND UPPER(cmu.name) like '%${contractManager.toUpperCase()}%' 
			</if>
			<!-- 订单类型 -->
			<if test="stOrderType != null and stOrderType != ''" >
				AND o.st_order_type = #{stOrderType, jdbcType=CHAR}
			</if>
		</trim>
	</select>
	
</mapper>
